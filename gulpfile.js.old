var gulp         = require('gulp');
var browserSync  = require('browser-sync');
var sass         = require('gulp-sass');
var minifyCSS 	 = require('gulp-minify-css');
var exec         = require('child_process').exec;

/* Main directories paths */
var dests = {
	html : './output_dev',
	sass : './output_dev/css'
};

var sources = {
	html : './src/htdocs/**',
	sass : './src/sass/**',
};

gulp.task('build', function(){
	return gulp.src(sources.html)
    	.pipe(gulp.dest(dests.html));
});

gulp.task('sass', function(){
	return gulp.src(sources.sass)
	        .pipe(sass())
	        .pipe(minifyCSS())
	        .pipe(gulp.dest(dests.sass));
});

gulp.task('browserSync', ['build', 'sass'], function() {
	browserSync({
        server: {
            baseDir: ['./output_dev', './src']
        },
        files: [
	    	"./output_dev/**",
	    ]
    });
});

gulp.task('watch', ['browserSync'], function() {
	gulp.watch(sources.sass, ['sass']);
	gulp.watch(sources.html, ['build']);
});

gulp.task('sculpin', function(){
    return exec('sculpin generate --watch', function(error, stdout, stderr){
        console.log(stderr);
    });
});


gulp.task('default', ['watch']);



// Docs
-> Source files (source folder)
-> Assets (assets folder)

// Transform SASS
// copy file to source folder
// Tranform stuff using scrulpin
// Lunch Browser sync (Gonna watch output folder)
